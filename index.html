<script>
    async function connectWallet() {
        console.log("ã‚¦ã‚©ãƒ¬ãƒƒãƒˆæ¥ç¶šã‚’è©¦ã¿ã¾ã™...");

        if (!window.solana || !window.solana.isPhantom) {
            alert("Phantomã‚¦ã‚©ãƒ¬ãƒƒãƒˆãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚");
            return;
        }

        console.log("Phantomã‚¦ã‚©ãƒ¬ãƒƒãƒˆãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸ:", window.solana);

        try {
            const response = await window.solana.connect();
            console.log("ã‚¦ã‚©ãƒ¬ãƒƒãƒˆæ¥ç¶šæˆåŠŸ:", response.publicKey.toString());
            document.getElementById("walletAddress").textContent = `ã‚¦ã‚©ãƒ¬ãƒƒãƒˆ: ${response.publicKey.toString()}`;

            // ğŸš€ RPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ã€Œèªè¨¼ä¸è¦ãªã‚‚ã®ã€ã«å¤‰æ›´
            const connection = new solanaWeb3.Connection("https://api.mainnet-beta.solana.com", "confirmed");

            // SOL æ®‹é«˜å–å¾—
            try {
                const solBalance = await connection.getBalance(new solanaWeb3.PublicKey(response.publicKey.toString()));
                document.getElementById("solBalance").textContent = `SOL æ®‹é«˜: ${(solBalance / solanaWeb3.LAMPORTS_PER_SOL).toFixed(4)} SOL`;
            } catch (solError) {
                console.error("SOLæ®‹é«˜å–å¾—ã‚¨ãƒ©ãƒ¼:", solError.message);
                document.getElementById("solBalance").textContent = "SOL æ®‹é«˜: ã‚¨ãƒ©ãƒ¼";
            }

            // GRI ãƒˆãƒ¼ã‚¯ãƒ³æ®‹é«˜å–å¾—
            const GRI_TOKEN_MINT_ADDRESS = "Va7yuUnSYdg23QjHjPAc9fkBrK3oD4mr3Ee52vFcyev";
            try {
                const tokenAccounts = await connection.getParsedTokenAccountsByOwner(
                    new solanaWeb3.PublicKey(response.publicKey.toString()),
                    { programId: new solanaWeb3.PublicKey("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA") }
                );

                let griBalance = 0;
                tokenAccounts.value.forEach(account => {
                    const mint = account.account.data.parsed.info.mint;
                    if (mint === GRI_TOKEN_MINT_ADDRESS) {
                        griBalance = account.account.data.parsed.info.tokenAmount.uiAmount;
                    }
                });

                document.getElementById("griBalance").textContent = `GRI æ®‹é«˜: ${griBalance} GRI`;

            } catch (griError) {
                console.error("GRIãƒˆãƒ¼ã‚¯ãƒ³å–å¾—ã‚¨ãƒ©ãƒ¼:", griError.message);
                document.getElementById("griBalance").textContent = "GRI æ®‹é«˜: ã‚¨ãƒ©ãƒ¼";
            }

        } catch (error) {
            console.error("ã‚¦ã‚©ãƒ¬ãƒƒãƒˆæ¥ç¶šã‚¨ãƒ©ãƒ¼:", error.message);
            alert(`ã‚¦ã‚©ãƒ¬ãƒƒãƒˆæ¥ç¶šã«å¤±æ•—ã—ã¾ã—ãŸ: ${error.message}`);
        }
    }

    document.getElementById("connectWallet").addEventListener("click", connectWallet);
</script>

<!-- Solana Web3.js -->
<script src="https://unpkg.com/@solana/web3.js@1.30.0/lib/index.iife.min.js"></script>
